<div class="page-content">
  <div class="container-fluid">

    <!-- start page title -->
    <!-- <app-breadcrumb></app-breadcrumb> -->
    <app-progress-bar></app-progress-bar>
    <!-- end page title -->


    <div class="row justify-content-center">
      <div class="col-xxl-9">
        <div class="card">
          <div class="card-body">
            <form #myForm="ngForm">
              <div class="row mb-3">
                <div class="col-lg-3">
                  <label for="quizNm" class="form-label-inline">{{
                    "course0104.quiz.quizDetail.quizNm" | translate
                    }}<span class="text-danger"> *</span></label>
                </div>
                <div class="col-lg-9">
                  <input type="text" required class="form-control " id="quizNm" name="quizNm"
                    placeholder="{{'course0104.quiz.quizDetail.placeholderQuizNm' | translate}}"
                    [(ngModel)]="quiz.quizNm" #quizNm="ngModel"
                    [ngClass]="{ 'is-invalid': (quizNm.invalid && submitted) || (quizNm.invalid && (quizNm.dirty || quizNm.touched))}" />
                  <div class="invalid-error"
                    *ngIf="(quizNm.invalid && submitted) || quizNm.invalid && (quizNm.dirty || quizNm.touched)">
                    <span *ngIf="quizNm.errors?.['required']">{{ 'message.requiredQuizName' | translate }}</span>
                  </div>
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-lg-3">
                  <label for="quizTime" class="form-label-inline">{{
                    "course0104.quiz.quizDetail.quizTime" | translate
                    }} {{
                      "course0104.quiz.quizDetail.minute" | translate
                      }}<span class="text-danger"> *</span></label>
                </div>
                <div class="col-lg-9">
                  <input type="number" required class="form-control " id="quizTime" name="quizTime"
                    placeholder="{{'course0104.quiz.quizDetail.placeholderQuizTime' | translate}}"
                    [(ngModel)]="quiz.quizTime" #quizTime="ngModel"
                    [ngClass]="{ 'is-invalid': (quizTime.invalid && submitted) || (quizTime.invalid && (quizTime.dirty || quizTime.touched))}" />
                  <div class="invalid-error"
                    *ngIf="(quizTime.invalid && submitted) || quizTime.invalid && (quizTime.dirty || quizTime.touched)">
                    <span *ngIf="quizTime.errors?.['required']">{{ 'message.requiredQuizName' | translate }}</span>
                  </div>
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-lg-3">
                  <label for="quizContent" class="form-label-inline">{{
                    "course0104.quiz.quizDetail.quizContent" | translate
                    }}<span class="text-danger"> *</span></label>
                </div>
                <div class="col-lg-9">
                  <textarea required class="form-control " id="quizContent" name="quizContent"
                    placeholder="{{'course0104.quiz.quizDetail.placeholderQuizContent' | translate}}"
                    [(ngModel)]="quiz.quizContent" #quizContent="ngModel"
                    [ngClass]="{ 'is-invalid': (quizContent.invalid && submitted) || (quizContent.invalid && (quizContent.dirty || quizContent.touched))}"></textarea>
                  <div class="invalid-error"
                    *ngIf="(quizContent.invalid && submitted) || quizContent.invalid && (quizContent.dirty || quizContent.touched)">
                    <span *ngIf="quizContent.errors?.['required']">{{ 'message.requiredQuizContent' | translate
                      }}</span>
                  </div>
                </div>
              </div>

              <div class="row mb-3" style="display: none;">
                <div class="col-lg-3">
                  <label for="quizType" class="form-label-inline">{{
                    "course0104.quiz.quizDetail.quizType" | translate
                    }}<span class="text-danger"> *</span></label>
                </div>
                <div class="col-lg-9">
                  <p-dropdown appendTo="body"
                    placeholder="{{'course0104.quiz.quizDetail.placeholderQuizType' | translate}}" [required]="true"
                    [options]="quizTypes" [(ngModel)]="quiz.quizType" optionLabel="commNm" optionValue="commCd"
                    [ngModelOptions]="{ standalone: true }" #quizType="ngModel"
                    [ngClass]="{ 'ng-invalid ng-dirty': (quizType.invalid && submitted) || quizType.invalid && (quizType.dirty || quizType.touched)}">
                  </p-dropdown>
                  <div class="invalid-error"
                    *ngIf="(quizType.invalid && submitted) || quizType.invalid && (quizType.dirty || quizType.touched)">
                    <span *ngIf="quizType.errors?.['required']">{{ 'course0104.quiz.quizDetail.quizTypeRequired' |
                      translate
                      }}</span>
                  </div>
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-lg-3">
                  <label for="ordNo" class="form-label-inline">{{
                    "course0101.lectureDetail.ordNo" | translate
                    }}</label>
                </div>
                <div class="col-lg-9">
                  <input type="number" class="form-control " id="ordNo" name="ordNo"
                    placeholder="{{'course0101.lectureDetail.placeholderOrdNo' | translate}}" [(ngModel)]="quiz.ordNo"
                    #url="ngModel" />
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-lg-3">
                  <label for="status-user" class="form-label-inline">{{
                    "sys3.userDetail.status" | translate
                    }}<span class="text-danger"> *</span></label>
                </div>

                <div class="col-lg-9">
                  <span class="form-check form-check-inline">
                    <label class="form-check-label" for="active">
                      {{"sys.sys0103.status.active" | translate }}
                    </label>
                    <input class="form-check-input" type="radio" name="status" id="active" (change)="quiz.status=true"
                      [checked]="quiz.status == true">
                  </span>
                  <span class="form-check form-check-inline">
                    <label class="form-check-label" for="disable">
                      {{"sys.sys0103.status.blocked" | translate }}
                    </label>
                    <input class="form-check-input" type="radio" name="status" id="disable" (change)="quiz.status=false"
                      [checked]="quiz.status == false">
                  </span>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary"
              (click)="goList()">
              {{ "button.back.title2" | translate }}
            </button>
            <button *ngIf="!quiz.cannotCRUD" type="button" class="btn btn-primary" (click)="onSave(myForm.invalid)">
              {{ "sys3.userDetail.buttonSave" | translate }}
            </button>
          </div>
          <!-- end card-body -->
        </div>
        <!-- end card -->
      </div>
      <!-- end col -->
    </div>
    <div class="row justify-content-center">
      <div class="col-xxl-9">
        <div class="card">
          <div class="card-body">
            <div class="modal-footer">
              <a *ngIf="!quiz.cannotCRUD" href="assets/file/templateQuiz.xls" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "course0104.quiz.quizDetail.downloadTemplate" | translate }}
              </a>

              <input #inputFile hidden type="file"
                accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                onclick="this.value = null" (change)="importExcel($event)" />

              <button (click)="exportPDF(quizId)" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "course0104.quiz.quizDetail.exportPDF" | translate }}
              </button>

              <button *ngIf="!quiz.cannotCRUD" (click)="inputFile.click()" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "course0104.quiz.quizDetail.importExcel" | translate }}
              </button>

              <button *ngIf="!quiz.cannotCRUD" (click)="addNewQuestion(0)" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "button.add.title" | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row justify-content-center">
      <ng-container *ngFor="let quizItem of listQuizItem; let index = index;">
        <div *ngIf="quizItem.crudType != 'D'" class="col-xxl-8" id="quizItem{{index}}">
          <div class="card">
            <div class="card-header align-items-center">
              <h4 class="card-title mb-0 flex-grow-1">{{ "course0104.quiz.quizDetail.question" | translate }}{{quizItem.index}}</h4>
            </div><!-- end card header -->
            <div class="card-body">
              <div class="live-preview">
                <!-- <form #quizItemForm="ngForm"> -->
                <div class="row mb-3">
                  <div class="col-lg-3">
                    <label for="quizType" class="form-label-inline">{{
                      "course0104.quiz.quizDetail.quizType" | translate
                      }}</label>
                  </div>
                  <div class="col-lg-9">
                    <p-dropdown appendTo="body"
                      placeholder="{{'course0104.quiz.quizDetail.placeholderQuizType' | translate}}" [required]="true"
                      [options]="quizItemTypes" [(ngModel)]="quizItem.quizItemType" optionLabel="commNm"
                      optionValue="commCd" [ngModelOptions]="{ standalone: true }" #quizType="ngModel">
                    </p-dropdown>
                  </div>
                </div>
                <ng-container *ngIf="quizItem.quizItemType == '08-03'">
                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="meassageInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.questionContent" | translate }}</label>
                    </div>
                    <div class="col-lg-9">
                      <textarea [(ngModel)]="quizItem.quizItemContent" name="quizItemContent" class="form-control"
                        id="meassageInput" rows="3" placeholder="Enter your message"></textarea>
                    </div>
                  </div>
                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="nameInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.answerContent" | translate }} A</label>
                    </div>
                    <div class="col-lg-9">
                      <input [(ngModel)]="quizItem.answerA" name="answerA" type="text" class="form-control"
                        id="nameInput" placeholder="Enter your content">
                    </div>
                  </div>
                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="nameInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.answerContent" | translate }} B</label>
                    </div>
                    <div class="col-lg-9">
                      <input [(ngModel)]="quizItem.answerB" name="answerB" type="text" class="form-control"
                        id="nameInput" placeholder="Enter your content">
                    </div>
                  </div>
                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="nameInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.answerContent" | translate }} C</label>
                    </div>
                    <div class="col-lg-9">
                      <input [(ngModel)]="quizItem.answerC" name="answerC" type="text" class="form-control"
                        id="nameInput" placeholder="Enter your content">
                    </div>
                  </div>
                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="nameInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.answerContent" | translate }} D</label>
                    </div>
                    <div class="col-lg-9">
                      <input [(ngModel)]="quizItem.answerD" name="answerD" type="text" class="form-control"
                        id="nameInput" placeholder="Enter your content">
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="nameInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.correctAnswer" | translate }}</label>
                    </div>
                    <div class="col-lg-9">
                      <p-multiSelect required #listClassCheckedvalid="ngModel" [options]="listCorrectAnswer"
                        [(ngModel)]="quizItem.answerCorrect" name="answerCorrect" defaultLabel="Chọn Đáp Án"
                        optionLabel="label" [style]="{'width':'100%'}"></p-multiSelect>
                    </div>
                  </div>
                </ng-container>
                <ng-container *ngIf="quizItem.quizItemType == '08-01'">
                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="meassageInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.questionContent" | translate }}</label>
                    </div>
                    <div class="col-lg-9">
                      <textarea [(ngModel)]="quizItem.quizItemContent" name="quizItemContent" class="form-control"
                        id="meassageInput" rows="3" placeholder="{{ 'course0104.quiz.quizDetail.enterQuestion' | translate }}"></textarea>
                    </div>
                  </div>

                  <div class="row mb-3" *ngFor="let answer of quizItem.listAnswer; let answerIndex = index">
                    <div class="col-lg-3">
                      <label for="nameInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.answerContent" | translate }} {{answerIndex+1}}</label>
                    </div>
                    <div class="col-lg-7">
                      <input [(ngModel)]="answer.answerContent" name="answerC" type="text" class="form-control"
                        id="nameInput" placeholder="{{ 'course0104.quiz.quizDetail.enterAnswer' | translate }}">
                    </div>
                    <div class="col-lg-2">
                      <button (click)="removeAnswer(quizItem.listAnswer, answerIndex)" *ngIf="quizItem.listAnswer.length > 1" type="button" class="btn btn-light waves-effect"><i class="ri-checkbox-indeterminate-line"></i></button>
                      <button (click)="addAnswer(quizItem.listAnswer)" *ngIf="answerIndex == quizItem.listAnswer.length - 1" type="button" class="btn btn-light waves-effect"><i class="ri-add-box-line"></i></button>
                    </div>

                  </div>

                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="nameInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.correctAnswer" | translate }}</label>
                    </div>
                    <div class="col-lg-9">
                      <p-multiSelect (onChange)="setCorrectAnswer(quizItem)" required #listClassCheckedvalid="ngModel" [options]="createMultiSelect(quizItem)"
                        [(ngModel)]="quizItem.listAnswerCorrect" name="answerCorrectFlex" defaultLabel="{{ 'iqTest.iqQues.iqQuesDetail.selectCorrectAnswer' | translate }}"
                        optionLabel="label" [style]="{'width':'100%'}"></p-multiSelect>
                    </div>
                  </div>

                </ng-container>
                <ng-container *ngIf="quizItem.quizItemType == '08-02'">
                  <div class="row mb-3">
                    <div class="col-lg-3">
                      <label for="meassageInput" class="form-label-inline">{{ "course0104.quiz.quizDetail.questionContent" | translate }}</label>
                    </div>
                    <div class="col-lg-9">
                      <textarea [(ngModel)]="quizItem.quizItemContent" name="quizItemContent" class="form-control"
                        id="meassageInput" rows="3" placeholder="{{ 'course0104.quiz.quizDetail.enterQuestion' | translate }}"></textarea>
                    </div>
                  </div>
                </ng-container>
                <div class="modal-footer">
                  <button *ngIf="!quiz.cannotCRUD" (click)="removeQuestion(index)" type="button"
                    class="btn rounded-pill btn-primary btn-label waves-effect right waves-light rounded-pill">
                    <i class="bx bx-trash label-icon align-middle rounded-pill fs-16 ms-2"></i>
                    {{ "button.delete.title" | translate }}
                  </button>
                </div>
                <!-- </form> -->
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </div>

    <div class="row justify-content-center"  *ngIf="listQuizItem.length >1">
      <div class="col-xxl-9">
        <div class="card">
          <div class="card-body">
            <div class="modal-footer">
              <!-- <a *ngIf="!quiz.cannotCRUD" href="assets/file/templateQuiz.xls" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "course0104.quiz.quizDetail.downloadTemplate" | translate }}
              </a>

              <input #inputFile hidden type="file"
                accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                onclick="this.value = null" (change)="importExcel($event)" />

              <button (click)="exportPDF(quizId)" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "course0104.quiz.quizDetail.exportPDF" | translate }}
              </button>

              <button *ngIf="!quiz.cannotCRUD" (click)="inputFile.click()" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "course0104.quiz.quizDetail.importExcel" | translate }}
              </button> -->
              <button *ngIf="!quiz.cannotCRUD" type="button" class="btn btn-primary" (click)="onSave(myForm.invalid)">
                {{ "sys3.userDetail.buttonSave" | translate }}
              </button>
              <button *ngIf="!quiz.cannotCRUD" (click)="addNewQuestion(0)" type="button"
                class="btn rounded-pill btn-primary btn-label waves-effect right waves-light">
                <i class="ri-file-add-line label-icon align-middle fs-16 ms-2"></i>
                {{ "button.add.title" | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>


  </div> <!-- container-fluid -->

</div>

<p-confirmDialog> </p-confirmDialog>
